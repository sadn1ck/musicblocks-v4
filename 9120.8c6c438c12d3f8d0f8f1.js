"use strict";(self.webpackChunkmusicblocks=self.webpackChunkmusicblocks||[]).push([[9120,7606],{7606:function(e,t,n){n.r(t),n.d(t,{default:function(){return c}});var i=n(885),s=n(5671),r=n(3144),a=n(9737),o=n(5178),c=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;(0,s.Z)(this,e),this._t=void 0===n?new a.default:n,this._ks=void 0===t?new o.default("major","c",this._t.numberOfSemitonesInOctave):t,this._semitoneIndex=i,this._octave=r,this._genericName=this._t.getNoteName(this._semitoneIndex),this._freq=this._t.getFreqByModalIndexAndOctave(this._semitoneIndex,this._octave),this._number=this._octave*this._t.numberOfSemitonesInOctave+this._semitoneIndex}return(0,r.Z)(e,[{key:"freq",get:function(){return this._freq}},{key:"octave",get:function(){return this._octave}},{key:"genericName",get:function(){return this._genericName}},{key:"semitoneIndex",get:function(){return this._semitoneIndex}},{key:"number",get:function(){return this._number}},{key:"_defineByFrequency",value:function(e){this._number=this._t.getNearestFreqIndex(e),this._freq=this._t.getFreqByIndex(this._number);var t=this._t.getModalIndexAndOctaveFromFreqIndex(this._number),n=(0,i.Z)(t,2);this._semitoneIndex=n[0],this._octave=n[1],this._genericName=this._t.getNoteName(this._semitoneIndex)}},{key:"setPitch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if("number"==typeof e)if(e%1!=0)this._defineByFrequency(e);else if(e>this._t.numberOfNotesInTemperament)this._defineByFrequency(e);else if(e>this._t.numberOfSemitonesInOctave){this._number=e,this._freq=this._t.getFreqByIndex(this._number);var n=this._t.getModalIndexAndOctaveFromFreqIndex(this._number),s=(0,i.Z)(n,2);this._semitoneIndex=s[0],this._octave=s[1],this._genericName=this._t.getNoteName(this._semitoneIndex)}else this._semitoneIndex=e,this._octave=t,this._genericName=this._t.getNoteName(this._semitoneIndex),this._freq=this._t.getFreqByModalIndexAndOctave(this._semitoneIndex,this._octave),this._number=this._t.getNearestFreqIndex(this._freq);else if("string"==typeof e){try{this._genericName=this._ks.convertToGenericNoteName(e)}catch(e){this._genericName=e.defaultValue}this._semitoneIndex=this._t.getModalIndex(this._genericName),this._octave=t,this._freq=this._t.getFreqByModalIndexAndOctave(this._semitoneIndex,this._octave),this._number=this._t.getNearestFreqIndex(this._freq)}}},{key:"applySemitoneTransposition",value:function(e){var t,n;try{var s=this._ks.semitoneTransform(this._genericName,e),r=(0,i.Z)(s,2);t=r[0],n=r[1]}catch(e){var a=(0,i.Z)(e.defaultValue,2);t=a[0],n=a[1]}this._genericName=t,this._octave+=n,this._semitoneIndex=this._t.getModalIndex(this._genericName),this._freq=this._t.getFreqByModalIndexAndOctave(this._semitoneIndex,this._octave),this._number=this._t.getNearestFreqIndex(this._freq)}},{key:"applyScalarTransposition",value:function(e){var t=this._ks.scalarTransform(this._genericName,e).slice(0,2),n=(0,i.Z)(t,2),s=n[0],r=n[1];this._genericName=s,this._octave+=r,this._semitoneIndex=this._t.getModalIndex(this._genericName),this._freq=this._t.getFreqByModalIndexAndOctave(this._semitoneIndex,this._octave),this._number=this._t.getNearestFreqIndex(this._freq)}},{key:"getSemitoneInterval",value:function(e){var t,n;try{var s=this._ks.semitoneTransform(this._genericName,e),r=(0,i.Z)(s,2);t=r[0],n=r[1]}catch(e){var a=(0,i.Z)(e.defaultValue,2);t=a[0],n=a[1]}var o=this._t.getModalIndex(t),c=this._octave+n;return this._t.getFreqByModalIndexAndOctave(o,c)}},{key:"getScalarInterval",value:function(e){var t=this._ks.scalarTransform(this._genericName,e).slice(0,2),n=(0,i.Z)(t,2),s=n[0],r=n[1],a=this._t.getModalIndex(s),o=this._octave+r;return this._t.getFreqByModalIndexAndOctave(a,o)}},{key:"toString",value:function(){return"".concat(this._genericName," ").concat(this._freq)}}]),e}()},9120:function(e,t,n){n.r(t);var i=n(7606);describe("class CurrentPitch",(function(){test("Instantiate with no arguments and expect generic note name and frequency to be 'n7' and 392 Hz, respectively",(function(){var e=new i.default;expect(Math.round(e.freq)).toBe(392),expect(e.genericName).toBe("n7")})),describe("Scalar transposition",(function(){describe("Scalar transpose from 392 Hz by 1 scalar step",(function(){var e=new i.default;e.applyScalarTransposition(1),test("Expect generic note name to be 'n9'",(function(){expect(e.genericName).toBe("n9")})),test("Expect frequency to be 440 Hz",(function(){expect(Math.round(e.freq)).toBe(440)})),test("Expect scalar interval -1 to be note with frequncy 392 Hz",(function(){expect(Math.round(e.getScalarInterval(-1))).toBe(392)}))}))})),describe("Semitone transposition",(function(){describe("Semitone transpose from 440 Hz previous by -2 half steps",(function(){var e=new i.default;e.applyScalarTransposition(1),e.applySemitoneTransposition(-2),test("Expect generic note name to be 'n7'",(function(){expect(e.genericName).toBe("n7")})),test("Expect frequency to be 392 Hz",(function(){expect(Math.round(e.freq)).toBe(392)})),test("Expect semitone interval 2 to be note with frequncy 440 Hz",(function(){expect(Math.round(e.getSemitoneInterval(2))).toBe(440)}))}))})),describe("Set pitch",(function(){var e=new i.default;test("Set pitch to 440 Hz and expect generic note name and frequency to be 'n9' and 440 Hz, respectively",(function(){e.setPitch(440),expect(e.genericName).toBe("n9"),expect(Math.round(e.freq)).toBe(440)})),test("Set pitch to modal index 7 and octave 4 and expect frequency to be 392 Hz",(function(){e.setPitch(7,4),expect(Math.round(e.freq)).toBe(392)})),test("Set pitch to generic note 'n7' and octave 4 and expect frequency to be 392 Hz",(function(){e.setPitch("n7",4),expect(Math.round(e.freq)).toBe(392)})),test("Set pitch to letter note 'g' and octave 4 and expect frequency to be 392 Hz",(function(){e.setPitch("g",4),expect(Math.round(e.freq)).toBe(392)})),test("Set pitch to solfege 'sol' and octave 4 and expect frequency to be 392 Hz",(function(){e.setPitch("sol",4),expect(Math.round(e.freq)).toBe(392)})),test("Set pitch to pitch number 55 and expect frequency to be 392 Hz",(function(){e.setPitch(55),expect(Math.round(e.freq)).toBe(392)}))}))}))}}]);